# 久坐提醒应用 - 设计文档

## 项目概述

这是一个基于Web的久坐提醒应用，帮助用户在长时间工作时提醒他们起身活动，以保护颈椎、肩部和腰部健康。应用支持中英文双语界面，提供计时功能、声音提醒和成就系统。

## 目录结构

```
/                       # 项目根目录
├── index.html          # 主HTML文件，定义页面结构
├── script.js           # JavaScript脚本，实现应用逻辑
├── styles.css          # CSS样式表（未显示但可推断存在）
├── notification.mp3    # 通知声音文件
├── notification.ogg    # 通知声音文件（兼容不同浏览器）
├── favicon.svg         # 网站图标
└── design.md           # 本设计文档
```

## 技术要点

### 1. 多语言支持

- 采用基于对象的语言配置方案
- 支持中英文切换，所有UI元素和通知内容均可自动翻译
- 结构化的翻译数据，包括按钮文本、提示信息、下拉菜单选项等

### 2. 计时器系统

- 工作和休息双计时器模式
- 可自定义工作和休息时间长度
- 倒计时显示，支持主页面和浮动窗口显示

### 3. 通知系统

- 多重通知机制：
  - 自定义弹窗提示
  - 系统通知（使用Web Notification API）
  - 声音提醒（多种音频实现方案）
- 声音提醒支持多种实现方式以提高兼容性：
  - 外部音频文件（MP3/OGG）
  - Web Audio API生成音频
  - 基于Data URI的内联音频

### 4. 音频处理

- 完整的音频生命周期管理
- 支持循环播放声音提醒
- 多种途径停止声音（按钮点击、ESC键、系统通知点击）
- 音频上下文和节点的创建、使用和清理

### 5. UI交互

- 响应式设计
- 状态清晰的按钮和提示
- 浮动窗口支持，允许用户在使用其他应用时看到剩余时间
- 成就系统，激励用户坚持进行休息

### 6. 状态管理

- 集中式状态管理模式
- 状态与UI更新分离
- 明确的工作/休息状态转换

## 核心功能

1. **工作/休息计时**：
   - 用户可以设置工作和休息的时间长度
   - 计时结束后自动通知用户

2. **声音提醒**：
   - 工作结束时播放声音提醒用户休息
   - 多种机制确保声音能在不同浏览器/设备上正常工作
   - 紧急停止声音功能，防止声音无法停止的问题

3. **语言切换**：
   - 支持中英文界面切换
   - 所有界面元素实时更新

4. **成就系统**：
   - 记录用户完成的工作和休息次数
   - 达到特定休息次数时显示成就

5. **浮动窗口**：
   - 紧凑的浮动窗口显示当前状态和剩余时间
   - 可最小化，不干扰正常工作

## 技术实现细节

### JavaScript架构

1. **模块化组织**：
   - `translations` - 多语言翻译对象
   - `elements` - DOM元素引用
   - `state` - 应用状态
   - `utils` - 工具函数
   - `timerFunctions` - 计时器相关函数

2. **事件处理**：
   - 基于事件委托的UI交互
   - 清理和重新绑定事件监听器，防止重复绑定

3. **音频处理**：
   - 多层次的音频错误处理和回退机制
   - 音频资源的动态创建和管理

### 用户界面

1. **主要组件**：
   - 语言选择器
   - 工作/休息时间设置
   - 计时器显示
   - 控制按钮
   - 成就显示
   - 浮动窗口
   - 自定义提示框

2. **状态反馈**：
   - 清晰的计时器状态显示
   - 工作/休息状态区分
   - 交互操作后的即时反馈

## 改进和扩展方向

1. **数据持久化**：
   - 添加本地存储，保存用户设置和统计数据
   - 支持跨设备同步（如通过云存储）

2. **增强提醒**：
   - 添加桌面提醒（如系统托盘图标）
   - 支持自定义提醒音效

3. **健康建议**：
   - 集成休息活动建议
   - 提供健康习惯统计和分析

4. **自定义主题**：
   - 支持暗/亮模式切换
   - 自定义界面颜色和样式

5. **导出统计**：
   - 支持导出使用数据
   - 生成健康习惯报告 